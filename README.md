# Магістерська робота: Розроблення засобів для управління фінансовими ризиками на основі гібридних нейромереж

Цей проєкт є частиною магістерської роботи, яка присвячена створенню гібридних нейромережевих засобів для управління фінансовими ризиками. У рамках роботи були розроблені моделі, алгоритми та середовище для навчання агента з підкріпленням, що дозволяє здійснювати прогнозування цін, кластеризацію ринкових станів і прийняття торгових рішень.

---

## 📑 Зміст
1. [Опис проєкту](#опис-проєкту)
2. [Основні компоненти](#основні-компоненти)
3. [Технології](#технології)
4. [Структура директорій](#структура-директорій)
5. [Інструкція зі встановлення](#інструкція-зі-встановлення)
6. [Контакти](#контакти)

---

## Опис проєкту

Метою роботи було розробити інтегровану систему для управління фінансовими ризиками, яка базується на:
- **Кластеризації трендів** — аналіз ринкових станів для ідентифікації шаблонів у даних.
- **Прогнозуванні цін** — використання регресійної моделі для прогнозу закриття цін активу.
- **Автоматизованих торгових стратегіях** — застосування підходу навчання з підкріпленням для оптимізації рішень агента.

Система проходила тестування на реальних історичних даних та порівнювалася з популярними стратегіями, такими як SMA Crossover.

---

## Основні компоненти

### 1. **Кластеризація трендів**
- Алгоритм кластеризації (K-means) аналізує дані за годинний інтервал.
- 8 кластерів представляють різні ринкові стани.

### 2. **Прогнозування цін**
- Модель регресії використовує історичні дані (24 години, 1440 точок).
- Прогнозує ціну закриття на годину вперед.

### 3. **Навчання агента**
- Використовується підхід навчання з підкріпленням (Reinforcement Learning).
- Агенти навчаються на основі технічних індикаторів (RSI, OBV, SMA).

### 4. **Оцінка стратегій**
- Порівняння стратегій SMA Crossover і Agent Based на основі метрик:
  - Profit Factor, Sharpe Ratio, Sortino Ratio тощо.
- Використання бібліотеки `Backtesting.py` для тестування.

---

## Технології

Проєкт створено з використанням наступних технологій:
- **Python**: основна мова програмування.
- **TensorFlow/Keras**: для побудови нейронних мереж.
- **Scikit-learn**: кластеризація та робота з даними.
- **Backtesting.py**: симуляція стратегій.
- **Joblib**: серіалізація моделей.
- **Matplotlib/Seaborn**: візуалізація результатів.

---

## Структура директорій

📂 Mastery-Trading  
├── 📂 backtest_research                # Тестування торгових стратегій  
│   ├── 📂 indicators                   # Індикатори для стратегій
│   │   ├── __init__.py                 
│   │   ├── technical_analysis.py       # Індикатори технічного аналізу
│   ├── 📂 strategies                   # Стратегії торгівлі
│   │   ├── __init__.py                 
│   │   ├── agent_based.py              # Стратегія на базі агента
│   │   ├── sma.py                      # Стратегія SMA Crossover
│   ├── etl_data_preparing.py           # ETL процес для підготовки даних
│   ├── main.ipynb                      # Notebook для тестування
├── 📂 clustering                       # Кластеризація
│   ├── 📂 models                       # Моделі  
│   │   ├── __init__.py                 
│   │   ├── clustering_model.py         # Модель кластеризації
│   │   ├── cnn.py                      # Згорткова нейромережа 
│   │   ├── fully_connected.py          # Повнозвʼязна нейромережа
│   ├── 📂 static                       # Директорія для збереження статичних даних(попередньо оброблені дані, навчені моделі тощо)
│   ├── etl_data_preparing.py           # ETL процес для підготовки даних  
│   ├── training.ipynb                  # Notebook для навчання та тестування  
├── 📂 database                         # База даних
│   ├── 📂 migrations                   # Міграції БД
│   │   ├── 📂 versions                 # Версії БД
│   │   │   ├── 7bb90ad93a3a_init.py    # Ініціюючий скрипт
│   │   ├── env.py                      # Налаштування ORM
│   ├── 📂 models                       # Моделі БД
│   │   ├── token.py                    # Модель для криптовалютних токенів та залежностей
│   ├── alembic.ini                     # Налаштування драйвера ORM
│   ├── Base.py                         # Підключення до БД
│   ├── config.py                       # Налаштування БД
├── 📂 parser                           # Збір даних
│   ├── 📂 historical                   # Історичні дані
│   │   ├── klines.py                   # Скрипт для збору історичних даних
│   │   ├── show_data.ipynb             # Notebook для попереднього аналізу даних
│   ├── config.py                       # Налаштування доступу до Binance
│   ├── depth.py                        # Поточний стан книги ордерів
│   ├── klines.py                       # Поточна ціна на токени
│   ├── tokens.py                       # Поточні доступні токени на ринку Binance
├── 📂 preprocessing                    # Попередня обробка даних
│   ├── 📂 data                         # Директорія для зберігання оброблених даних
│   │   ├── BTCUSDT.csv.bz2             # Версія даних валютної пари BTC/USDT
│   ├── 📂 etl                          # ETL процеси  
│   │   ├── __init__.py                 
│   │   ├── klines_to_csv.py            # Витягування даних з БД в CSV  
│   │   ├── normalize.py                # Нормалізація даних
│   ├── 📂 scaler                       # Директорія для зберігання статичних обʼєктів нормалізатора
├── 📂 regression                       # Регресія
│   ├── 📂 static                       # Директорія для збереження статичних даних(попередньо оброблені дані, навчені моделі тощо)  
│   ├── etl_data_preparing.py           # ETL процес для підготовки даних  
│   ├── model.py                        # Модель BiLSTM  
│   ├── training.ipynb                  # Notebook для навчання та тестування  
├── 📂 reinforcement                    # Навчання з підкріпленням  
│   ├── 📂 static                       # Директорія для збереження статичних даних(попередньо оброблені дані, навчені моделі тощо)  
│   ├── agent.py                        # Агент
│   ├── environment.py                  # Середовище
│   ├── etl_data_preparing.py           # ETL процес для підготовки даних  
│   ├── policy_network.py               # Модель для політики агента  
│   ├── training.ipynb                  # Notebook для навчання та тестування  
└── .env                                # Файл з налаштуваннями середовища проекту 
└── .gitignore                          
└── README.md                           # Документація проєкту 
└── utils.py                            # Додатковий функціонал

---

## Інструкція зі встановлення

### 1. Клонування репозиторію
```bash
git clone https://github.com/the2roock/Mastery-Trading-with-RL.git
cd Mastery-Trading-with-RL
```
### 2. Створення віртуального середовища
```bash
python -m venv env
source env/bin/activate  # Для Linux/macOS
env\Scripts\activate     # Для Windows
```
### 3. Налаштування змінних середовища
```bash
vim .env # Своріть .env файл

# Налаштуйте наступні змінні
DATABASE_HOST=<Ваш хост бази даних>
DATABASE_USER=<Ваш користувач бази даних>
DATABASE_PORT=<Ваш порт бази даних>
DATABASE_PASSWORD=<Ваш пароль бази даних>
DATABASE_NAME=<Ваша назва бази даних>
BINANCE_API_KEY=<Ваш АРІ-ключ до Binance-API>
BINANCE_API_SECRET=<Ваш АРІ-пароль до Binance-API>

# Активуйте змінні середовища
export $(grep -v '^#' ../.env | xargs)
```
### 4. Встановлення залежностей
```bash
pip install -r requirements.txt
```
### 5. Запуск аналізу
* Відкрийте та виконайте Jupyter Notebooks для навчання моделей, аналізу та візуалізації у відповідних директоріях.
---

## Контакти
### Author: [Maksym Petrynko](https://github.com/the2roock)
### Gmail: maksympetrynko68@gmail.com

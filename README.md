# Магістерська робота: Реалізація засобів на основі гібридних нейромереж для управління фінансовими ризиками

Цей проєкт є частиною магістерської роботи, яка присвячена створенню гібридних нейромережевих засобів для управління фінансовими ризиками. У рамках роботи були розроблені моделі, алгоритми та середовище для навчання агента з підкріпленням, що дозволяє здійснювати прогнозування цін, кластеризацію ринкових станів і прийняття торгових рішень.

---

## 📑 Зміст
1. [Опис проєкту](#опис-проєкту)
2. [Основні компоненти](#основні-компоненти)
3. [Технології](#технології)
4. [Структура директорій](#структура-директорій)
5. [Інструкція зі встановлення](#інструкція-зі-встановлення)
6. [Контакти](#контакти)

---

## Опис проєкту

Метою роботи було розробити інтегровану систему для управління фінансовими ризиками, яка базується на:
- **Кластеризації трендів** — аналіз ринкових станів для ідентифікації шаблонів у даних.
- **Прогнозуванні цін** — використання регресійної моделі для прогнозу закриття цін активу.
- **Автоматизованих торгових стратегіях** — застосування підходу навчання з підкріпленням для оптимізації рішень агента.

Система проходила тестування на реальних історичних даних та порівнювалася з популярними стратегіями, такими як SMA Crossover.

---

## Основні компоненти

### 1. **Кластеризація трендів**
- Алгоритм кластеризації (K-means) аналізує дані за годинний інтервал.
- 8 кластерів представляють різні ринкові стани.

### 2. **Прогнозування цін**
- Модель регресії використовує історичні дані (24 години, 1440 точок).
- Прогнозує ціну закриття на годину вперед.

### 3. **Навчання агента**
- Використовується підхід навчання з підкріпленням (Reinforcement Learning).
- Агенти навчаються на основі технічних індикаторів (RSI, OBV, SMA).

### 4. **Оцінка стратегій**
- Порівняння стратегій SMA Crossover і Agent Based на основі метрик:
  - Profit Factor, Sharpe Ratio, Sortino Ratio тощо.
- Використання бібліотеки `Backtesting.py` для тестування.

---

## Технології

Проєкт створено з використанням наступних технологій:
- **Python**: основна мова програмування.
- **TensorFlow/Keras**: для побудови нейронних мереж.
- **Scikit-learn**: кластеризація та робота з даними.
- **Backtesting.py**: симуляція стратегій.
- **Joblib**: серіалізація моделей.
- **Matplotlib/Seaborn**: візуалізація результатів.

---

## Структура директорій

📂 Mastery-Trading  
│
├── 📂 backtest_research                # Дані для аналізу (історичні ціни, індикатори)  
│   ├── 📂 indicators                   # Кластеризація даних  
│   │   ├── __init__.py                 # Кластеризація даних  
│   │   ├── technical_analysis.py       # Кластеризація даних  
│   ├── 📂 strategies                   # Кластеризація даних  
│   │   ├── __init__.py                 # Кластеризація даних  
│   │   ├── agent_based.py              # Кластеризація даних  
│   │   ├── sma.py                      # Кластеризація даних  
│   ├── etl_data_preparing.py           # Кластеризація даних  
│   ├── main.py                         # Кластеризація даних 
│
├── 📂 clustering                       # Збережені моделі регресії, кластеризації, агента  
│   ├── 📂 models                       # Кластеризація даних  
│   │   ├── __init__.py                 # Кластеризація даних  
│   │   ├── clustering_model.py         # Кластеризація даних  
│   │   ├── cnn.py                      # Кластеризація даних  
│   │   ├── fully_connected.py          # Кластеризація даних  
│   ├── 📂 static                       # Кластеризація даних  
│   ├── etl_data_preparing.py           # Кластеризація даних  
│   ├── training.ipynb                  # Кластеризація даних  
│
├── 📂 database                         # Jupyter Notebook з аналізом  
│   ├── 📂 migrations                   # Кластеризація даних  
│   │   ├── 📂 versions                 # Кластеризація даних  
│   │   │   ├── 7bb90ad93a3a_init.py    # Кластеризація даних  
│   │   ├── env.py                      # Кластеризація даних  
│   ├── 📂 models                       # Кластеризація даних  
│   │   ├── token.py                    # Кластеризація даних  
│   ├── alembic.ini                     # Кластеризація даних  
│   ├── Base.py                         # Кластеризація даних  
│   ├── config.py                       # Кластеризація даних  
│
├── 📂 parser                           # Основний код  
│   ├── 📂 historical                   # Кластеризація даних  
│   │   ├── klines.py                   # Кластеризація даних  
│   │   ├── show_data.ipynb             # Кластеризація даних  
│   ├── config.py                       # Кластеризація даних  
│   ├── depth.py                        # Прогнозування цін  
│   ├── klines.py                       # Реалізація агента з підкріпленням  
│   ├── tokens.py                       # Визначення торгового середовища  
│
├── 📂 preprocessing                    # Результати тестування та графіки  
│   ├── 📂 data                         # Кластеризація даних  
│   │   ├── BTCUSDT.csv.bz2             # Кластеризація даних  
│   ├── 📂 etl                          # Кластеризація даних  
│   │   ├── __init__.py                 # Кластеризація даних  
│   │   ├── klines_to_csv.py            # Кластеризація даних  
│   │   ├── normalize.py                # Кластеризація даних  
│   ├── 📂 scaler                       # Кластеризація даних  
│
├── 📂 regression                       # Результати тестування та графіки  
│   ├── 📂 static                       # Кластеризація даних  
│   ├── etl_data_preparing.py           # Кластеризація даних  
│   ├── model.py                        # Кластеризація даних  
│   ├── training.ipynb                  # Кластеризація даних  
│
├── 📂 reinforcement                    # Результати тестування та графіки  
│   ├── 📂 static                       # Кластеризація даних  
│   ├── agent.py                        # Кластеризація даних  
│   ├── environment.py                  # Кластеризація даних  
│   ├── etl_data_preparing.py           # Кластеризація даних  
│   ├── policy_network.py               # Кластеризація даних  
│   ├── training.ipynb                  # Кластеризація даних  
└── .env                                # Документація проєкту 
└── .gitignore                          # Документація проєкту 
└── README.md                           # Документація проєкту 
└── utils.py                            # Документація проєкту 

---

## Інструкція зі встановлення

### 1. Клонування репозиторію
```bash
git clone https://github.com/the2roock/Mastery-Trading-with-RL.git
cd Mastery-Trading-with-RL
```
### 2. Створення віртуального середовища
```bash
python -m venv env
source env/bin/activate  # Для Linux/macOS
env\Scripts\activate     # Для Windows
```
### 3. Налаштування змінних середовища
```bash
vim .env # Своріть .env файл

# Налаштуйте наступні змінні
DATABASE_HOST=<Ваш хост бази даних>
DATABASE_USER=<Ваш користувач бази даних>
DATABASE_PORT=<Ваш порт бази даних>
DATABASE_PASSWORD=<Ваш пароль бази даних>
DATABASE_NAME=<Ваша назва бази даних>
BINANCE_API_KEY=<Ваш АРІ-ключ до Binance-API>
BINANCE_API_SECRET=<Ваш АРІ-пароль до Binance-API>

# Активуйте змінні середовища
export $(grep -v '^#' ../.env | xargs)
```
### 4. Встановлення залежностей
```bash
pip install -r requirements.txt
```
### 5. Запуск аналізу
* Відкрийте та виконайте Jupyter Notebooks для навчання моделей, аналізу та візуалізації у відповідних директоріях.
---

## Контакти
Author: the2roock
Gmail: maksympetrynko68@gmail.com
